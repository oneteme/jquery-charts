<div class="basic-test-container">
  <h1>Page de Test des Graphiques</h1>

  <div class="description">
    <p>
      Cette page permet de tester l'intégration de la bibliothèque jQuery-Charts
      avec jquery-core + jquery-apexcharts ou jquery-highcharts et de reproduire
      certains effets de bord relevés. Vous pouvez utiliser le panneau de
      contrôle en bas pour sélectionner le graphique à afficher.
    </p>

    <div class="library-toggle">
      <button
        class="library-btn"
        (click)="toggleChartLibrary()"
        title="Basculer entre ApexCharts et Highcharts"
      >
        Utiliser
        {{ chartLibrary === "apexcharts" ? "Highcharts" : "ApexCharts" }}
      </button>

      <div class="separator"></div>

      <button
        class="data-mode-btn"
        [class.active]="useSimpleData"
        (click)="setDataType(true)"
        title="Utiliser des données simples"
      >
        <span class="label">Simple</span>
      </button>

      <button
        class="data-mode-btn"
        [class.active]="!useSimpleData"
        (click)="setDataType(false)"
        title="Utiliser des données complexes"
      >
        <span class="label">Complex</span>
      </button>

      <div class="separator"></div>

      <button
        class="sandbox-btn"
        routerLink="/basic-test/sandbox"
        title="Tester avec vos propres données"
      >
        Tester avec un jeu de données perso
      </button>
    </div>
  </div>

  <div class="charts-container">
    <div class="chart-wrapper">
      <app-apexcharts-chart-test
        *ngIf="chartLibrary === 'apexcharts'"
        [chartType]="chartType"
        [chartConfig]="chartConfig"
        [chartData]="chartData"
      ></app-apexcharts-chart-test>

      <app-highcharts-test
        *ngIf="chartLibrary === 'highcharts'"
        [chartType]="chartType"
        [chartConfig]="chartConfig"
        [chartData]="chartData"
        [isLoadingChart]="isLoadingData"
      ></app-highcharts-test>
    </div>
  </div>

  <!-- debug -->
  <div class="debug-panel">
    <h3>Informations de Debug</h3>
    <div class="debug-info">
      <p>
        <strong>Bibliothèque utilisée :</strong> {{ getCurrentLibraryName() }}
      </p>
      <p><strong>Type de graphique :</strong> {{ chartType }}</p>
      <p><strong>Type de données :</strong> {{ getCurrentMode() }}</p>
      <p><strong>Nombre de données :</strong> {{ chartData?.length || 0 }}</p>
      <p><strong>Délai de chargement :</strong> {{ dataDelay }}ms</p>
      <p>
        <strong>État :</strong> {{ isLoadingData ? "Chargement..." : "Prêt" }}
      </p>
    </div>
  </div>

  <!-- Contrôles simples (sticky) -->
  <div class="control-panel-simple" [class.hidden]="!isPanelVisible">
    <div class="control-group">
      <label for="chart-type-select">Type de graphique :</label>
      <select
        id="chart-type-select"
        [(ngModel)]="chartType"
        (change)="changeChartType()"
      >
        <option value="pie">Pie</option>
        <option value="donut">Donut</option>
        <option value="funnel">Funnel</option>
        <option value="pyramid">Pyramid</option>
        <option value="polar">Polar</option>
        <option value="radar">Radar</option>
        <option value="radar">RadarArea</option>
        <option value="radialBar">Radial Bar</option>
        <option value="bar">Bar</option>
        <option value="column">Column</option>
        <option value="columnpyramid">Column Pyramid</option>
        <option value="line">Line</option>
        <option value="area">Area</option>
        <option value="spline">Spline</option>
        <option value="areaspline">Area Spline</option>
        <option value="columnrange">Column Range</option>
        <option value="arearange">Area Range</option>
        <option value="areasplinerange">Area Spline Range</option>
        <option value="scatter">Scatter</option>
        <option value="bubble">Bubble</option>
        <option value="heatmap">Heatmap</option>
        <option value="treemap">Treemap</option>
        <option value="boxplot">BoxPlot</option>
      </select>
    </div>

    <div class="control-group">
      <button
        class="btn reload-btn"
        (click)="reloadData()"
        title="Recharger les données"
      >
        Recharger
      </button>
    </div>
  </div>

  <button
    class="toggle-panel-btn"
    (click)="toggleControlPanel()"
    title="{{ isPanelVisible ? 'Masquer' : 'Afficher' }} le panneau de contrôle"
  >
    {{ isPanelVisible ? "✕" : "≡" }}
  </button>
</div>
